(()=>{"use strict";class e{constructor(e,t,i){this.id=this.uuidv4(),this.equipe=e,this.couleur=t,this.pv_max=10,this._pv=this.pv_max}get pv(){return this._pv}set pv(e){this._pv=e,$(`#pv-${this.id}`).html(this.pv),!this.pv>0&&$("#"+this.id).fadeOut(600,(function(){$(this).remove()}))}get html(){return`<div class='pion animate__animated ${this.couleur}' id='${this.id}'></div>`}uuidv4(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}))}define_position(e){this.coord={x:e.x,y:e.y}}}class t{constructor(e,t){this.nom=e,this.couleur=t}}var i=console.log,o=["Acid_Apple","Acid_Pain","Acid_Rain","Acid_Sky","Acid_Voice","Bad_Apple","Bad_Book","Bad_Actor","Black_Book","Black_Pain","Blue_Apple","Blue_Lullaby","Blue_Rain","Breaking_Glass","Breaking_Ground","Breaking_Point","Broken_Chains","Broken_Glass","Broken_Lullaby","Broken_Melody","Broken_Shield","Broken_Sky","Broken_Thread","Broken_Void","Crazy_Apple","Electric_Apple","Electric_Blue","Electric_Box","Electric_Chain","Electric_City","Electric_Cube","Electric_Doll","Electric_Dream","Electric_Epic","Electric_Feel","Electric_Fire","Electric_Light","Electric_Lullaby","Electric_Machine","Electric_Man","Electric_Message","Electric_Pain","Electric_Point","Electric_Rain","Electric_Red","Electric_Sheep","Electric_Shock","Electric_Sky","Electric_Sleep","Electric_Snow","Electric_Sound","Electric_Star","Electric_Voice","Electric_Voice","Electric_Void","Electric_Wall","Electric_Wire","Empty_Voice","Empty_Void","Fantom_Freaks","Fantom_Pain","Fantom_Rain","Frontier_Freaks","Frozen_Apple","Frozen_Chains","Frozen_Glass","Frozen_Ground","Frozen_Pain","Frozen_Point","Frozen_Rain","Frozen_Shield","Frozen_Sky","Frozen_Void","Glass_Chains","Glass_Shield","Glass_Sky","Glass_Wall","Icy_Sky","Iron_Chains","Iron_Shield","Iron_Sky","Iron_Thread","Liquid_Pain","Liquid_Sky","Liquid_Void","Phantom_Thread","Phantom_Void","Royal_Guard","Solid_Glass","Solid_Ground","Solid_Pain","Solid_Rain","Solid_Void","Stolen_Book","Void_Dream","Void_Sky","Void_Voice"],s=e=>[{x:e.x+1,y:e.y},{x:e.x-1,y:e.y},{x:e.x,y:e.y+1},{x:e.x,y:e.y-1}];class r{constructor(){this.ligne_max,this.colone_max,this.pion_actif=null,this.case_movement=[],this.case_portee=[],this.pions=[],this.equipes={}}_RNG(e){return Math.floor(Math.random()*Math.floor(e))}coordonnees_to_querySelector(e){return`.x${e.x}.y${e.y}`}coordonnees_from_classes(e){return{x:Number(e[1].split("x")[1]),y:Number(e[2].split("y")[1])}}coordonnees_aleatoires(){return{x:this._RNG(this.colone_max-1)+1,y:this._RNG(this.ligne_max-1)+1}}_distance(e,t){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}reset_damier(e,i){this.ligne_max=e,this.colone_max=i;let o=this._pick_random_colors(),s=this._pick_random_names();this.equipes={equipe1:new t(s[0],"lin-"+o[0]),equipe2:new t(s[1],"lin-"+o[1])},this._create_teams(3),this._dessin_damier(),this._spawn(),this._case_events()}_pick_random_colors(){let e=[];e[0]=this._RNG(6);do{e[1]=this._RNG(6)}while(e[0]==e[1]);return e}_pick_random_names(){let e=[];e[0]=o[this._RNG(o.length)];do{e[1]=o[this._RNG(o.length)]}while(e[0]==e[1]);return e}_create_teams(t){this.pions=[],$(".panel .teams").html("");for(let i in this.equipes){$(".panel .teams").append(`<div id="${this.equipes[i].nom}" class="p-2"><h2>${this.equipes[i].nom}</h2></div>`);for(let o=t;o>0;o--)this.pions.push(new e(this.equipes[i].nom,this.equipes[i].couleur))}}_dessin_damier(){$("#grille").html("");for(let e=0;e<this.ligne_max;e++){$("#grille").append(`<div class="ligne_${e}"></div>`);for(let t=0;t<this.colone_max;t++)$(".ligne_"+e).append(`<div class="case x${t} y${e}"></div>`)}}_spawn(){let e;for(let t of this.pions){do{e=this.coordonnees_aleatoires()}while(""!=$(this.coordonnees_to_querySelector(e)).html());$(this.coordonnees_to_querySelector(e)).append(t.html),t.define_position(e),$(`#${t.equipe}`).append(`\n\t\t\t\t<div id="info_${t.id}" class="p-1 d-flex">\n\t\t\t\t\t<span class="circle ${t.couleur} mr-2"></span>\n\t\t\t\t\t<span id="coord-${t.id}">x${t.coord.x} : y${t.coord.y}</span>\n\t\t\t\t\t<span class="ml-2"> [ <span id="pv-${t.id}">${t.pv}</span> / ${t.pv_max} ]<span/>\n\t\t\t\t</div>\n\t\t\t`)}}_move(e,t){let i=this.coordonnees_to_querySelector(t);""==$(i).html()&&($(this.coordonnees_to_querySelector(e.coord)).html(""),$(i).append(e.html),e.define_position(t),$(`#coord-${e.id}`).html(`x${e.coord.x} : y${e.coord.y}`)),this._identifiers()}_get_area(e,t,i){let o=[];o.push(e);for(let e=0;e<t-1;e++)for(let e of o){let t=s(e);for(let e=0;e<t.length;e++){const s=t[e];i?i&&""==$(this.coordonnees_to_querySelector(s)).html()&&o.push(s):o.push(s)}o=Array.from(new Set(o))}return o}draw_area(e,t){$(".case").removeClass("attack"),$(".case").removeClass("movement");let i=this._get_area(this.coordonnees_from_classes($(".active")[0].classList),3,t);for(let t of i)$(this.coordonnees_to_querySelector(t)).addClass(e)}clear_board_classes(){$(".case").removeClass("active").removeClass("movement").removeClass("attack").removeClass("attack"),$(".pion").removeClass("animate__bounce"),$('*[id^="info_"]').removeClass("red"),this.pion_actif=null}_case_events(){$(".case").click((e=>{if(Array.from(e.target.classList).includes("case")||(e.target=e.target.parentNode),null==this.pion_actif&&e.target.children.length&&Array.from(e.target.classList).includes("tour"))this.clear_board_classes(),i(e.target.children[0].id),this.pion_actif=this.pions.find((t=>t.id==e.target.children[0].id)),$(this.coordonnees_to_querySelector(this.pion_actif.coord)).addClass("active");else if(null!=this.pion_actif&&e.target.children.length&&Array.from(e.target.classList).includes("attack"))this.clear_board_classes(),e.target.children[0].classList.add("animate__bounce"),i(e.target.children[0].id),this.pions.find((t=>t.id==e.target.children[0].id)).pv-=5;else if(null!=this.pion_actif&&e.target.children.length&&Array.from(e.target.classList).includes("tour"))this.clear_board_classes(),this.pion_actif=this.pions.find((t=>t.id==e.target.children[0].id)),$(this.coordonnees_to_querySelector(this.pion_actif.coord)).addClass("active");else if(null!=this.pion_actif&&Array.from(e.target.classList).includes("movement")){$(this.coordonnees_to_querySelector(this.pion_actif.coord)).removeClass("tour");let t={x:Number(Array.from(e.target.classList)[1].split("x")[1]),y:Number(Array.from(e.target.classList)[2].split("y")[1])};this._move(this.pion_actif,t),$(this.coordonnees_to_querySelector(t)).addClass("tour"),this.clear_board_classes()}else this.clear_board_classes();$('*[id^="info_"]').removeClass("red"),null!=this.pion_actif&&(console.log({id:this.pion_actif.id,coord:this.pion_actif.coord}),$(`#info_${this.pion_actif.id}`).addClass("red"))})),this._identifiers()}_identifiers(){$(".pion").hover((e=>{$(`#info_${e.target.id}`).css("background","cyan")})),$(".pion").mouseout((e=>{$(`#info_${e.target.id}`).css("background","transparent")}))}}var a=console.log,l=1;function n(){let e=plateau.equipes["equipe"+l].nom,t=plateau.pions.filter((t=>t.equipe==e));$("#tour").html(e),a(t);for(let e=0;e<t.length;e++)t[e].pv>0&&$(plateau.coordonnees_to_querySelector(t[e].coord)).addClass("tour")}$("form").submit((function(e){e.preventDefault(),plateau=new r,$("#compte_ligne").val()+$("#compte_colone").val()<6?alert("valeur incorectes"):(plateau.reset_damier($("#compte_ligne").val(),$("#compte_colone").val()),$(".all").hide(),n())})),$(".deplacement").click((()=>{null!=plateau.pion_actif&&$(".active")&&plateau.draw_area("movement",1)})),$(".attack").click((()=>{null!=plateau.pion_actif&&$(".active")&&plateau.draw_area("attack",0)})),$(".clearBoard").click((()=>{plateau.clear_board_classes()})),$(".fin").click((()=>{l=1==l?2:1,$(".case").removeClass("tour"),n(equipes)}))})();